{% extends 'base.html.twig' %}

{% block title %}{{ title }} - Administration{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('styles/pages/admin.css') }}">
{% endblock %}

{% block body %}
<div class="admin-container">
    <div class="form-container">
        <!-- Breadcrumb -->
        <div class="breadcrumb">
            <a href="{{ path('admin_oeuvres') }}" class="breadcrumb-link">üìö ≈íuvres</a>
            <span class="breadcrumb-separator">‚Ä∫</span>
            <span class="breadcrumb-current">{{ title }}</span>
        </div>

        <!-- Header -->
        <div class="admin-header">
            <a href="{{ path('admin_oeuvres') }}" class="back-btn">
                ‚Üê Retour √† la liste
            </a>
            <h1 class="admin-title">
                {% if oeuvre.id %}‚úèÔ∏è Modifier l'≈ìuvre{% else %}‚ú® Cr√©er une ≈ìuvre{% endif %}
            </h1>
            <p class="admin-subtitle">G√©rez les informations de votre manga</p>
        </div>

        <!-- Formulaire -->
        <div class="form-card">
            {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}
            
            <div class="form-grid">
                <div>
                    <div class="form-group">
                        {{ form_label(form.titre) }}
                        {{ form_widget(form.titre) }}
                        {{ form_errors(form.titre) }}
                    </div>

                    <div class="form-group">
                        {{ form_label(form.auteur) }}
                        {{ form_widget(form.auteur) }}
                        {{ form_errors(form.auteur) }}
                        <div class="form-help">
                            S√©lectionnez un auteur existant ou <a href="{{ path('admin_auteurs_new') }}" target="_blank" style="color: var(--accent-primary);">cr√©ez-en un nouveau</a>
                        </div>
                    </div>

                    <div class="form-group">
                        {{ form_label(form.statut) }}
                        {{ form_widget(form.statut) }}
                        {{ form_errors(form.statut) }}
                    </div>

                    <div class="form-group">
                        {{ form_label(form.type) }}
                        {{ form_widget(form.type) }}
                        {{ form_errors(form.type) }}
                    </div>

                    <div class="form-group">
                        {{ form_label(form.datePublication) }}
                        {{ form_widget(form.datePublication) }}
                        {{ form_errors(form.datePublication) }}
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        {{ form_label(form.mangadxId) }}
                        {{ form_widget(form.mangadxId) }}
                        {{ form_errors(form.mangadxId) }}
                        <div class="form-help">
                            ID unique de l'≈ìuvre sur MangaDx (optionnel)<br>
                            üí° <strong>Comment l'obtenir :</strong> Allez sur <a href="{{ path('app_oeuvre_list') }}" target="_blank" style="color: var(--accent-primary);">le catalogue des ≈ìuvres</a>, 
                            trouvez votre manga et copiez l'ID depuis l'URL (ex: a1b2c3d4-e5f6-7g8h-9i0j-k1l2m3n4o5p6)<br>
                            üîÑ <strong>Laissez vide</strong> pour cr√©er une ≈ìuvre sans lien MangaDx
                        </div>
                    </div>

                    <div class="form-group">
                        {{ form_label(form.tags, 'Genres') }}
                        {{ form_widget(form.tags) }}
                        {{ form_errors(form.tags) }}
                        <div class="form-help">S√©lectionne un ou plusieurs genres pour cette ≈ìuvre. Tu peux en ajouter, modifier ou retirer.</div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                {{ form_label(form.description) }}
                {{ form_widget(form.description) }}
                {{ form_errors(form.description) }}
                <div class="form-help">D√©crivez bri√®vement l'histoire et l'univers de cette ≈ìuvre</div>
            </div>

            <div class="form-group">
                {{ form_label(form.couverture) }}
                {{ form_widget(form.couverture) }}
                {{ form_errors(form.couverture) }}
                <div class="form-help">
                    URL de l'image de couverture (format JPG, PNG, WebP recommand√©)<br>
                    üí° <strong>Conseil :</strong> Utilisez une image de haute qualit√© pour un meilleur rendu
                </div>
            </div>

            <div class="form-actions">
                <a href="{{ path('admin_oeuvres') }}" class="btn btn-secondary">
                    ‚ùå Annuler
                </a>
                <button type="submit" class="btn btn-primary">
                    {% if oeuvre.id %}üíæ Mettre √† jour{% else %}‚ú® Cr√©er l'≈ìuvre{% endif %}
                </button>
            </div>

            {{ form_end(form) }}
        </div>

        <!-- Messages flash -->
        {% for flash_message in app.session.flashbag.get('success') %}
            <div class="alert alert-success">
                ‚úÖ {{ flash_message }}
            </div>
        {% endfor %}

        {% for flash_message in app.session.flashbag.get('error') %}
            <div class="alert alert-error">
                ‚ùå {{ flash_message }}
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
