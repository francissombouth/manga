{% extends 'base.html.twig' %}

{% block title %}MangaThÃ¨que - Votre collection de mangas{% endblock %}

{% block body %}
<div class="main-container">
    <!-- Contenu principal -->
    <main>
        <!-- Header hÃ©roÃ¯que -->
        <div class="collection-header">
            <h1 class="collection-title">ðŸ”¥ MangaThÃ¨que</h1>
            <p class="collection-subtitle">DÃ©couvrez, lisez et collectionnez vos mangas prÃ©fÃ©rÃ©s</p>
            <div class="collection-stats">
                <div class="stat-item">
                    <span class="stat-number">{{ totalOeuvres }}</span>
                    <span class="stat-label">Mangas</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ totalChapitres }}</span>
                    <span class="stat-label">Chapitres</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ totalAuteurs }}</span>
                    <span class="stat-label">Auteurs</span>
                </div>
            </div>
        </div>

        <!-- Section Popular Today -->
        <section class="section">
            <div class="section-header">
                <h2 class="section-title">
                    ðŸ”¥ Popular Today
                </h2>
                <a href="{{ path('app_oeuvre_list') }}" class="section-link">VIEW ALL</a>
            </div>

            {% if oeuvres is not empty %}
                <div class="manga-grid">
                    {% for oeuvre in oeuvres|slice(0, 6) %}
                        <div class="manga-card">
                            <!-- Badge nouveau si rÃ©cent -->
                            {% if oeuvre.chapitres|length > 0 %}
                                {% set latestChapter = oeuvre.chapitres|first %}
                                {% if latestChapter.createdAt|date('Y-m-d') == "now"|date('Y-m-d') %}
                                    <div class="new-badge">NEW</div>
                                {% endif %}
                            {% endif %}

                            <!-- Couverture du manga -->
                            <div class="manga-cover-container">
                                {% if oeuvre.couverture %}
                                    <img src="{{ oeuvre.couverture }}" alt="{{ oeuvre.titre }}" class="manga-cover">
                                {% else %}
                                    <div class="manga-cover" style="background: linear-gradient(45deg, #374151, #4b5563); display: flex; align-items: center; justify-content: center; color: #9ca3af; font-size: 3rem;">
                                        ðŸ“–
                                    </div>
                                {% endif %}
                            </div>

                            <!-- Informations du manga -->
                            <div class="manga-info">
                                <h3 class="manga-title">{{ oeuvre.titre }}</h3>
                                <p class="manga-author">
                                    {% if oeuvre.auteur %}
                                        {{ oeuvre.auteur.nom }}
                                    {% else %}
                                        Auteur inconnu
                                    {% endif %}
                                </p>

                                <div class="manga-meta">
                                    <span class="manga-type">{{ oeuvre.type|default('MANGA') }}</span>
                                    <span class="chapters-count">{{ oeuvre.chapitres|length }} ch.</span>
                                </div>

                                <div class="manga-actions">
                                    <a href="{{ path('app_oeuvre_show', {'id': oeuvre.id}) }}" class="btn-read">
                                        Lire Maintenant
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <h3>Bienvenue sur MangaThÃ¨que</h3>
                    <p>Commencez votre aventure manga dÃ¨s maintenant !</p>
                    <a href="{{ path('app_register') }}" class="btn-primary">
                        ðŸš€ CrÃ©er un compte
                    </a>
                </div>
            {% endif %}
        </section>

        <!-- Section Latest Updates -->
        {% if oeuvres|length > 6 %}
        <section class="section">
            <div class="section-header">
                <h2 class="section-title">
                    ðŸ“… Latest Updates
                </h2>
                <a href="{{ path('app_oeuvre_list') }}" class="section-link">VIEW ALL</a>
            </div>

            <div class="manga-grid">
                {% for oeuvre in oeuvres|slice(6, 6) %}
                    <div class="manga-card">
                        <!-- Couverture du manga -->
                        <div class="manga-cover-container">
                            {% if oeuvre.couverture %}
                                <img src="{{ oeuvre.couverture }}" alt="{{ oeuvre.titre }}" class="manga-cover">
                            {% else %}
                                <div class="manga-cover" style="background: linear-gradient(45deg, #374151, #4b5563); display: flex; align-items: center; justify-content: center; color: #9ca3af; font-size: 3rem;">
                                    ðŸ“–
                                </div>
                            {% endif %}
                        </div>

                        <!-- Informations du manga -->
                        <div class="manga-info">
                            <h3 class="manga-title">{{ oeuvre.titre }}</h3>
                            <p class="manga-author">
                                {% if oeuvre.auteur %}
                                    {{ oeuvre.auteur.nom }}
                                {% else %}
                                    Auteur inconnu
                                {% endif %}
                            </p>

                            <div class="manga-meta">
                                <span class="manga-type">{{ oeuvre.type|default('MANGA') }}</span>
                                <span class="chapters-count">{{ oeuvre.chapitres|length }} ch.</span>
                            </div>

                            <div class="manga-actions">
                                <a href="{{ path('app_oeuvre_show', {'id': oeuvre.id}) }}" class="btn-read">
                                    Lire Maintenant
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>
        {% endif %}
    </main>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-section">
            <h3 class="sidebar-title">
                TRENDING THIS WEEK
            </h3>
            <ul class="trending-list">
                {% set trendingMangas = oeuvres|slice(0, 5) %}
                {% for oeuvre in trendingMangas %}
                    <li class="trending-item">
                        <div class="trending-rank">{{ loop.index }}</div>
                        <div class="trending-info">
                            <div class="trending-title">{{ oeuvre.titre }}</div>
                            <div class="trending-chapters">{{ oeuvre.chapitres|length }} chapters</div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <!-- Section des actions rapides -->
        <div class="sidebar-section">
            <h3 class="sidebar-title">
                âš¡ Actions Rapides
            </h3>
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <a href="{{ path('app_oeuvre_list') }}" class="btn-primary" style="text-align: center; padding: 0.5rem;">
                    ðŸ“š Catalogue
                </a>
                {% if not app.user %}
                    <a href="{{ path('app_register') }}" class="btn-primary" style="text-align: center; background: linear-gradient(135deg, #10b981, #059669); padding: 0.5rem;">
                        ðŸš€ S'inscrire
                    </a>
                {% endif %}
            </div>
        </div>

        <!-- Section des statistiques -->
        <div class="sidebar-section">
            <h3 class="sidebar-title">
                ðŸ“Š Statistiques
            </h3>
            <div style="display: flex; flex-direction: column; gap: 0.3rem;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: var(--text-secondary); font-size: 0.85rem;">Mangas</span>
                    <span style="color: var(--accent-purple); font-weight: 600;">{{ totalOeuvres }}</span>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: var(--text-secondary); font-size: 0.85rem;">Chapitres</span>
                    <span style="color: var(--accent-purple); font-weight: 600;">{{ totalChapitres }}</span>
                </div>
            </div>
        </div>
    </aside>
</div>


{% endblock %} 